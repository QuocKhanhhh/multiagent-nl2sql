[
  {
    "question": "Số lượng bài viết có cảm xúc tích cực trong tháng 3 năm 2023?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE fa.sentiment = 'pos' AND d.year = 2023 AND d.month = 3;"
  },
  {
    "question": "Top 5 nguồn có tổng số từ cao nhất trong năm 2022?",
    "ground_truth_sql": "SELECT da.source_name, SUM(fa.word_count) AS total_words FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2022 GROUP BY da.source_name ORDER BY total_words DESC LIMIT 5;"
  },
  {
    "question": "Tác giả nào có bài viết dài nhất theo thời gian đọc?",
    "ground_truth_sql": "SELECT da.author_name, fa.read_time FROM dw.fact_articles fa JOIN dw.dim_authors da ON fa.author_id = da.author_id ORDER BY fa.read_time DESC LIMIT 1;"
  },
  {
    "question": "Số lượng bài viết có từ khóa 'công nghệ' trong năm 2021?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE fa.keywords ILIKE '%công nghệ%' AND d.year = 2021;"
  },
  {
    "question": "Chủ đề nào có trung bình số từ thấp nhất trong năm 2020?",
    "ground_truth_sql": "SELECT dt.topic_name, AVG(fa.word_count) AS avg_words FROM dw.fact_articles fa JOIN dw.dim_topics dt ON fa.topic_id = dt.topic_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2020 GROUP BY dt.topic_name ORDER BY avg_words ASC LIMIT 1;"
  },
  {
    "question": "Có bao nhiêu bài viết vào ngày 15/6/2022?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.full_date = '2022-06-15';"
  },
  {
    "question": "Tổng thời gian đọc của các bài viết theo từng chủ đề?",
    "ground_truth_sql": "SELECT dt.topic_name, SUM(fa.read_time) AS total_read_time FROM dw.fact_articles fa JOIN dw.dim_topics dt ON fa.topic_id = dt.topic_id GROUP BY dt.topic_name;"
  },
  {
    "question": "Tác giả nào có bài viết cảm xúc tiêu cực nhất trong năm 2023?",
    "ground_truth_sql": "SELECT da.author_name, COUNT(*) AS cnt FROM dw.fact_articles fa JOIN dw.dim_authors da ON fa.author_id = da.author_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE fa.sentiment = 'neg' AND d.year = 2023 GROUP BY da.author_name ORDER BY cnt DESC LIMIT 1;"
  },
  {
    "question": "Số lượng bài viết có thời gian đọc dưới 5 phút?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles WHERE read_time < 5;"
  },
  {
    "question": "Nguồn nào có nhiều bài viết cảm xúc trung lập nhất trong tháng 10/2022?",
    "ground_truth_sql": "SELECT da.source_name , SUM(CASE sentiment WHEN 'neu' THEN 1 ELSE 0 END) AS neutrality_score FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE (d.year = 2022 AND d.month = 10) GROUP BY da.source_name ORDER BY neutrality_score DESC LIMIT 1;"
  },
  {
    "question": "Có bao nhiêu tác giả viết ít nhất 5 bài trong năm 2021?",
    "ground_truth_sql": "SELECT COUNT(*) FROM (SELECT author_id, COUNT(*) AS cnt FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2021 GROUP BY author_id HAVING COUNT(*) >= 5) t;"
  },
  {
    "question": "Bài viết nào có tiêu đề chứa 'AI' trong năm 2023?",
    "ground_truth_sql": "SELECT da.title FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE da.title ILIKE '%AI%' AND d.year = 2023;"
  },
  {
    "question": "Số lượng bài viết theo từng năm và cảm xúc?",
    "ground_truth_sql": "SELECT d.year, fa.sentiment, COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id GROUP BY d.year, fa.sentiment ORDER BY d.year, fa.sentiment;"
  },
  {
    "question": "Chủ đề nào có tổng thời gian đọc thấp nhất trong năm 2022?",
    "ground_truth_sql": "SELECT dt.topic_name, SUM(fa.read_time) AS total_read_time FROM dw.fact_articles fa JOIN dw.dim_topics dt ON fa.topic_id = dt.topic_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2022 GROUP BY dt.topic_name ORDER BY total_read_time ASC LIMIT 1;"
  },
  {
    "question": "Tác giả nào có trung bình thời gian đọc bài viết cao nhất?",
    "ground_truth_sql": "SELECT da.author_name, AVG(fa.read_time) AS avg_read_time FROM dw.fact_articles fa JOIN dw.dim_authors da ON fa.author_id = da.author_id GROUP BY da.author_name ORDER BY avg_read_time DESC LIMIT 1;"
  },
  {
    "question": "Số lượng bài viết của từng nguồn trong tháng 2 năm 2023?",
    "ground_truth_sql": "SELECT da.source_name, COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2023 AND d.month = 2 GROUP BY da.source_name;"
  },
  {
    "question": "Có bao nhiêu bài viết có số từ dưới 500 trong năm 2020?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE fa.word_count < 500 AND d.year = 2020;"
  },
  {
    "question": "Top 3 ngày có nhiều bài viết cảm xúc tích cực nhất?",
    "ground_truth_sql": "SELECT d.full_date, COUNT(*) AS cnt FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE fa.sentiment = 'pos' GROUP BY d.full_date ORDER BY cnt DESC LIMIT 3;"
  },
  {
    "question": "Nguồn nào có trung bình số từ bài viết thấp nhất?",
    "ground_truth_sql": "SELECT da.source_name, AVG(fa.word_count) AS avg_words FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id GROUP BY da.source_name ORDER BY avg_words ASC LIMIT 1;"
  },
  {
    "question": "Số lượng tác giả duy nhất theo từng chủ đề trong năm 2022?",
    "ground_truth_sql": "SELECT dt.topic_name, COUNT(DISTINCT fa.author_id) FROM dw.fact_articles fa JOIN dw.dim_topics dt ON fa.topic_id = dt.topic_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2022 GROUP BY dt.topic_name;"
  },
  {
    "question": "Có bao nhiêu bài viết có từ khóa 'sức khỏe'?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles WHERE keywords ILIKE '%sức khỏe%';"
  },
  {
    "question": "Tổng số từ của các bài viết trong tháng 11 năm 2021?",
    "ground_truth_sql": "SELECT SUM(fa.word_count) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2021 AND d.month = 11;"
  },
  {
    "question": "Tác giả nào có số bài viết giảm nhiều nhất từ năm 2021 sang 2022?",
    "ground_truth_sql": "SELECT da.author_name, COUNT(CASE WHEN d.year = 2021 THEN 1 END) - COUNT(CASE WHEN d.year = 2022 THEN 1 END) AS decrease FROM dw.fact_articles fa JOIN dw.dim_authors da ON fa.author_id = da.author_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year IN (2021, 2022) GROUP BY da.author_name ORDER BY decrease DESC LIMIT 1;"
  },
  {
    "question": "Có bao nhiêu ngày trong năm 2020 không có bài viết nào?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.dim_date d WHERE d.year = 2020 AND d.date_id NOT IN (SELECT DISTINCT fa.date_id FROM dw.fact_articles fa);"
  },
  {
    "question": "Top 5 bài viết có thời gian đọc dài nhất trong năm 2023?",
    "ground_truth_sql": "SELECT da.title, fa.read_time FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2023 ORDER BY fa.read_time DESC LIMIT 5;"
  },
  {
    "question": "Số lượng bài viết có cảm xúc tiêu cực của từng nguồn?",
    "ground_truth_sql": "SELECT da.source_name, COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id WHERE fa.sentiment = 'negative' GROUP BY da.source_name;"
  },
  {
    "question": "Chủ đề nào có bài viết dài nhất theo số từ trong năm 2021?",
    "ground_truth_sql": "SELECT dt.topic_name, MAX(fa.word_count) FROM dw.fact_articles fa JOIN dw.dim_topics dt ON fa.topic_id = dt.topic_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2021 GROUP BY dt.topic_name ORDER BY MAX(fa.word_count) DESC LIMIT 1;"
  },
  {
    "question": "Có bao nhiêu bài viết có tiêu đề chứa 'môi trường' trong năm 2022?",
    "ground_truth_sql": "SELECT COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_articles da ON fa.article_id = da.article_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE da.title ILIKE '%môi trường%' AND d.year = 2022;"
  },
  {
    "question": "Tác giả nào có số bài viết trung bình mỗi tháng cao nhất trong năm 2022?",
    "ground_truth_sql": "SELECT t.author_name, AVG(cnt) FROM (SELECT da.author_name, d.month, COUNT(*) AS cnt FROM dw.fact_articles fa JOIN dw.dim_authors da ON fa.author_id = da.author_id JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2022 GROUP BY da.author_name, d.month) t GROUP BY t.author_name ORDER BY AVG(cnt) DESC LIMIT 1;"
  },
  {
    "question": "Số lượng bài viết mỗi ngày trong tháng 12 năm 2021?",
    "ground_truth_sql": "SELECT d.full_date, COUNT(*) FROM dw.fact_articles fa JOIN dw.dim_date d ON fa.date_id = d.date_id WHERE d.year = 2021 AND d.month = 12 GROUP BY d.full_date ORDER BY d.full_date;"
  }
]